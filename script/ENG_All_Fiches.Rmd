---
title: ''
author: ''
date: ''
output:
  pdf_document: default
  html_document:
    df_print: paged
  word_document:
    number_sections: no
    reference_docx: ../output/Template_matu.docx
    df_print: paged
---
  

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = TRUE)

library(dplyr, warn.conflicts = FALSE)
library(readxl, warn.conflicts = FALSE)
library(knitr, warn.conflicts = FALSE)
library(magick, warn.conflicts = FALSE)
library(jpeg, warn.conflicts = FALSE)
library(png, warn.conflicts = FALSE)
library(imager, warn.conflicts = FALSE)

Dataphoto <- read_excel("../data/photo_mat.xlsx",sheet=2)
Datascale <- read_excel("../data/matu_scale.xlsx",sheet=2)
Logo <- read_excel("../data/matu_scale.xlsx",sheet=3)
Datataille <- read_excel("../data/matu_scale.xlsx",sheet=4)


```


```{r longueur, echo= FALSE, out.width = '250px', results='asis', warning=FALSE}

#PH <- c("A-IMMATURE", "B - DEVELOPING", "C-SPAWNING", "D-REGRETION/REGENERATION", "E-OMITTED SPAWNING", "F-ABNORMAL")
PH <- c("A - IMMATURE", "B - DEVELOPING")

 species2 = c("Dicentrachus labrax","Engraulis encrasilocus","Mullus surmuletus", "Solea solea", "Sprattus sprattus", "Sardina pilchardus", "Gadidae sp.", "Flat fish sp.", "Chelidonichthys cuculus", "Lophius sp.", "Scomber scombrus","Trachurus trachurus","Zeus faber","Clupea clupea","Merluccius merluccius")
  name2 = c("Sea bass","Anchovy","Red mullet", "Sole", "Sprat", "Sardine", "Gadidae", "Flat fish", "Red gurnard", "Monkfish", "Mackerel","Scad","Peter's fish","Harrengus","Hake")
 code2 = c("Dicentrachus labrax (DICE LAB)","Engraulis encrasilocus (ENGR ENCR)","Mullus surmuletus (MUL SUR)", "Solea solea (SOL SOL)", "Sprattus sprattus (SPR SPR)", "Sardina pilchardus (SARD PIL)", "Gadidae sp. (GAD)", "Flat fish sp. (FLAT)", "Chelidonichthys cuculus (ASPI CUC)", "Lophius sp. (LOPH)", "Scomber scombrus (SCOM SCO)","Trachurus trachurus (TRAC TRU)","Zeus faber (ZEUS FAB)","Clupea clupea (CLUP CLU)","Merluccius merluccius (MERL MCC)")



```




```{r tableau, echo= FALSE, out.width = '250px', results='asis', warning=FALSE}

df <- data.frame(
  species = c("Dicentrarchus labrax"),
  name = c("Sea bass"),
 code = c("Dicentrachus labrax (DICE LAB)")
)
df

```




```{r boucle, echo=FALSE, results="asis", out.width='250px'}

options(grid.grid.raster.NA = "../data/NA.png")
options(readJPEG.NA = "../data/NA.png")

for(j in 1:nrow(df)){
 pander::pandoc.header("MATURITE",level=1)
  pander::pandoc.header(df$name[j],level=2)
 pander::pandoc.header(df$code[j],level=2)
 grid::grid.newpage()
 grid::grid.raster(readPNG('../data/Flogo.png'),x = 0.5, y = 0.5, just = "center")
 cat(' \n')
 Ftaille <- Datataille %>% filter(Species==df$species[j],Sexe=="F")
 pander::pandoc.header(Ftaille$Title[j],level=4)
 pander::pandoc.header(Ftaille$FMS[j],level=5)
 cat(' \n')  
  for(b in 1:length(PH)){
  pander::pandoc.header(PH[b],level=3)
  textASB<-Datascale %>% filter(Species==df$species[j],Phase==PH[b],Sexe=="F")
  textASB <- textASB$Text
  tab <- data.frame(x = textASB)
  colnames(tab) <- c(" ")
  kable(tab)
  print(kable(tab))
  ASB<-Dataphoto %>% filter(Species==df$species[j],Phase==PH[b], Sexe=="F", Fiches='oui')
  ASB <- ASB$`Link`
  for(i in 1:length(ASB)){
  grid::grid.newpage()
  grid::grid.raster(readJPEG(ASB[i]))
  cat(' \n')  
  } 
  }
  cat("\n\n\\newpage\n")
  cat(' \n')
  pander::pandoc.header("MATURITE",level=1)
  pander::pandoc.header(df$name[j],level=2)
 pander::pandoc.header(df$code[j],level=2)
 grid::grid.newpage()
 grid::grid.raster(readPNG('../data/Mlogo.png'),x = 0.5, y = 0.5, just = "center")
 cat(' \n')
 Mtaille <- Datataille %>% filter(Species==df$species[j],Sexe=="M")
 pander::pandoc.header(Mtaille$Title[j],level=4)
 pander::pandoc.header(Mtaille$FMS[j],level=5)
 cat(' \n')  
  for(b in 1:length(PH)){
  pander::pandoc.header(PH[b],level=3)
  textASB<-Datascale %>% filter(Species==df$species[j],Phase==PH[b],Sexe=="M")
  textASB <- textASB$Text
  tab <- data.frame(x = textASB)
  colnames(tab) <- c(" ")
  kable(tab)
  print(kable(tab))
  ASB<-Dataphoto %>% filter(Species==df$species[j],Phase==PH[b], Sexe=="M", Fiches=='oui')
  ASB <- ASB$`Link`
  for(i in 1:length(ASB)){
  grid::grid.newpage()
  grid::grid.raster(readJPEG(ASB[i]),interpolate=FALSE)
  cat(' \n')  
  } 
  }
cat("\n\n\\newpage\n")
}

```






